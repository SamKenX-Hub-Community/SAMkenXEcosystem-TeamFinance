
<!DOCTYPE html>

<html lang="en">

<head>

 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <meta http-equiv="X-UA-Compatible" content="ie=edge">

 <title>TradeFinance Smart Contract</title>

 <link rel="stylesheet" type="text/css" href="TradeFinanceHome.css">

 <style>
* {box-sizing: border-box}
body {font-family: "Lato", sans-serif;}

/* Style the tab */
.tab {
    float: left;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
    width: 30%;
}

/* Style the buttons inside the tab */
.tab button {
    display: block;
    background-color: inherit;
    color: black;
    padding: 22px 16px;
    width: 100%;
    border: none;
    outline: none;
    text-align: left;
    cursor: pointer;
    transition: 0.3s;
    font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
    background-color: #ddd;
}

/* Create an active/current "tab button" class */
.tab button.active {
    background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
    float: left;
    padding: 0px 12px;
    border: 1px solid #ccc;
    width: 80%;
    border-left: none;
}

.NavigationBar1 {

    float : left;
    padding: 6px 8px 6px 16px;
    text-decoration: none;
    font-size: 22px;
    color: #818181;
    padding-top: 50px;
}


</style>

 
</head>


<body>

    <div class="header" style="color: #302827; width: 95%">

        <a class="Header-Home" onclick='processNavigationBar_ToHome(event);' href="./TradeFinanceHome.html">TradeFinanceHome</a>

        <div class="NavigationBar">

            <a class="Buyer" onclick='processNavigationBar_ToBuyer(event);' href="./TradeBuyer.html">Buyer</a>
            <a class="Seller" onclick='processNavigationBar_ToSeller(event);' href="./TradeSeller.html">Seller</a>
            <a class="Contact-Info" onclick='processNavigationBar_ToContactInfo(event);' href="./TFContactInfo.html">Contract-US</a>

        </div>

    </div>

    <div class="container" style="width: 100%">

        <div class="LeftBrowserBox" style="width: 12%">

            <div class="NavigationBar1">

                <a class="Seller" onclick='processNavigationBar_ToSeller(event);' href="./TradeSeller.html">ShowTrade</a>
                <a class="Seller" onclick='processNavigationBar_ToSeller(event);' href="./TFSeller.html">ShowLC</a>

            </div>

        </div>

        <div class="RightBrowserBox" style="width: 85%; float: left">

            <h1 class="Shipment-Order-Details-Header">Trade Details</h1>

            <div class="tab">
                <button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen">Buyer1</button>
                <button class="tablinks" onclick="openCity(event, 'Paris')">Buyer2</button>
                <button class="tablinks" onclick="openCity(event, 'Tokyo')">Buyer3</button>
            </div>

            <div id="London" class="tabcontent">

                <table class="Buyer-Bank-Shipment-Order-Details">

                    <tr class="Shipment-Details-TableRow-Header">

                        <th class="Shipment-Details-TableHeader">TradeId</th>
                        <th class="Shipment-Details-TableHeader">Buyer</th>
                        <th class="Shipment-Details-TableHeader">Shipment</th>
                        <th class="Shipment-Details-TableHeader">ShipmentCount</th>
                        <th class="Shipment-Details-TableHeader">Amount</th>
                        <th class="Shipment-Details-TableHeader">Status</th>
                        <th class="Shipment-Details-TableHeader"></th>
                    </tr>

                    <!-- ToDo : Dynamically add the Shipment order details : New rows -->

                    <tr class="Shipment-Details-TableRow-Content">

                        <td class="Shipment-Details-Content">TD1</td>
                        <td class="Shipment-Details-Content">Dealer</td>
                        <td class="Shipment-Details-Content">BMW X5</td>
                        <td class="Shipment-Details-Content">10</td>
                        <td class="Shipment-Details-Content">100000</td>
                        <td class="Shipment-Details-Content"><div id="myDIV">Pending</div></td>
                        <td class="Shipment-Details-Content"><button onclick="myFunction()">AcceptTrade</button></td>
                    </tr>

                </table>

            </div>

            <div class="Retrieve-Trade-Details" style="clear: left">

                <br /><br /><br />
                <label id="Label_buffer" style="padding-right: 6%; padding-left: 6%">TradeId</label>
                <input id="Trade-Id-Input" type="text">
                <br /><br /><br />

                <label id="Label_buffer" style="padding-right: 12%"></label>
                <button id="Accept-Trade-Button" class="Accept-Trade-Class">Accept Trade</button>

            </div>

        </div>

        <div id="Paris" class="tabcontent">
            <table class="Buyer-Bank-Shipment-Order-Details">

                <tr class="Shipment-Details-TableRow-Header">

                    <th class="Shipment-Details-TableHeader">TradeId</th>
                    <th class="Shipment-Details-TableHeader">Buyer</th>
                    <th class="Shipment-Details-TableHeader">Shipment</th>
                    <th class="Shipment-Details-TableHeader">ShipmentCount</th>
                    <th class="Shipment-Details-TableHeader">Amount</th>
                    <th class="Shipment-Details-TableHeader">Status</th>
                    <th class="Shipment-Details-TableHeader"></th>
                </tr>

                <!-- ToDo : Dynamically add the Shipment order details : New rows -->

                <tr class="Shipment-Details-TableRow-Content">

                    <td class="Shipment-Details-Content">TD1</td>
                    <td class="Shipment-Details-Content">Dealer</td>
                    <td class="Shipment-Details-Content">BENZ X5</td>
                    <td class="Shipment-Details-Content">20</td>
                    <td class="Shipment-Details-Content">100000</td>
                    <td class="Shipment-Details-Content"><div id="myDIV">Pending</div></td>
                    <td class="Shipment-Details-Content"><button onclick="myFunction()">AcceptTrade</button></td>
                </tr>

            </table>
        </div>

        <div id="Tokyo" class="tabcontent">
            <h3>Buyer3</h3>
            <p>Tokyo is the capital of Japan.</p>
        </div>

    </div>


    <script>
        function myFunction() {
            var x = document.getElementById("myDIV");
            if (x.innerHTML === "Pending") {
                x.innerHTML = "Approved";
            }
        }
    </script>

    <script>

        function openCity(evt, cityName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(cityName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Get the element with id="defaultOpen" and click on it

        document.getElementById("defaultOpen").click();

    </script>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

    <script>

    /****************************************************************************************
    Accept Trade : Change the status of Trade Agreement in mongo db by changing it to "Trade Accepted"
    *****************************************************************************************/

    /****************************************************************************************
    Accept Trade : Place HyperLedger API Call
    *****************************************************************************************/

        $("#Accept-Trade-Button").click(function () {


            var webServerPrefix = "http://216.218.231.7:3000/tfbc/"
            var xmlhttp;
            var httpRequestString = webServerPrefix + "acceptTrade";

            xmlhttp = new XMLHttpRequest();

            xmlhttp.open("POST", httpRequestString, true);
            xmlhttp.setRequestHeader("Content-type", "application/json");
            xmlhttp.setRequestHeader("accept", "application/json");

            // Wait for Async response and Handle it in web page

            xmlhttp.onreadystatechange = function () {

                if (this.readyState == 4 && this.status == 200) {

                    //Parse the JSON Response Object

                    responseObject = JSON.parse(this.response);
                    alert("Received Success Response from Server for tradeAccept call :=> " + responseObject);

                } else {

                    alert("Failure to place tradeAccept call :=> Status : " + this.status + " readyState : " + this.readyState);
                }

            };

            // Prepare Http Request from Form-data and send the request

            var taId_value = document.getElementById("Trade-Id-Input").value;

            obj = { taId: taId_value };
            params = JSON.stringify(obj);

            if (taId_value == null) {

                alert("Trade Agreement Id value is missing while accepting Trade : ");
            }
            else {

                alert("Calling acceptTrade with Params :" + params);
                xmlhttp.send(params);
            }
        });

    </script>

</body>

</html>


